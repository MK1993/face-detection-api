const register=(e,t,n,s)=>{const{email:r,name:i,password:o}=e.body;if(!r||!i||!o)return t.status(400).json("incorrect form submission");const a=s.hashSync(o);n.transaction(e=>{e.insert({hash:a,email:r}).into("login").returning("email").then(n=>e("users").returning("*").insert({email:n[0],name:i,joined:new Date}).then(e=>{t.json(e[0])})).then(e.commit).catch(e.rollback)}).catch(e=>t.status(400).json("unable to register"))};module.exports={register:register};