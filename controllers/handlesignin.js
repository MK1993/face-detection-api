const signin=(s,e,n,t)=>{const{email:a,password:o}=s.body;0!==a.length&&0!==o.length||e.status(400).json("Wrong inputs criteria"),t.select("hash","email").from("login").where("email","=",a).then(s=>{n.compareSync(o,s[0].hash)?t.select("*").from("users").where("email","=",a).then(s=>{e.json(s[0])}).catch(s=>e.status(400).json("Unable to get a user!")):e.status(400).json("Wrong credentials!")}).catch(s=>{e.status(400).json("Wrong credentials!")})};module.exports={signin:signin};